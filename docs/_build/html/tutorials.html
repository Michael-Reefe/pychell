
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorials &#8212; pychell  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/pychell_logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Extending" href="extending.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="tutorials">
<span id="id1"></span><h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rv-fitting">
<h2>RV Fitting<a class="headerlink" href="#rv-fitting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>Here we perform Bayesian inference on a radial-velocity dataset. This example fits RVs of KELT-24, known to host a transiting 5.5 day massive hot Jupiter on a moderately eccentric orbit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Base Python libraries</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Import numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Import pychell orbits module</span>
<span class="kn">import</span> <span class="nn">pychell.orbits</span> <span class="k">as</span> <span class="nn">pco</span>

<span class="c1"># Path to input rv file and outputs for outputs</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;kelt24_rvs.txt&#39;</span>

<span class="c1"># The name of the star for plots</span>
<span class="n">star_name</span> <span class="o">=</span> <span class="s1">&#39;KELT-24&#39;</span>

<span class="c1"># Mass and uncertainty of star for mass determination (solar units)</span>
<span class="n">mstar</span> <span class="o">=</span> <span class="mf">1.460</span>
<span class="n">mstar_unc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.059</span><span class="p">,</span> <span class="mf">0.055</span><span class="p">]</span> <span class="c1"># -, +</span>

<span class="c1"># All data in one dictionary from a radvel formatted file</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">CompositeRVData</span><span class="o">.</span><span class="n">from_radvel_file</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="c1"># Init parameters and planets dictionary</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameters</span><span class="p">()</span>
<span class="n">planets_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Used later to set initial values</span>
<span class="n">jitter_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;TRES&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;SONG&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>

<span class="c1"># Define parameters for planet 1</span>
<span class="c1"># Other bases are available, this fits for P, TC, ECC, W, K.</span>
<span class="n">planets_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;basis&quot;</span><span class="p">:</span> <span class="n">pco</span><span class="o">.</span><span class="n">TCOrbitBasis</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span>

<span class="c1"># Values from Rodriguez et al. 2019 for KELT-24 b</span>
<span class="c1"># Given the extremely precise values for P and TC from the multiple transits, there is no reason to fit for P and TC here.</span>
<span class="c1"># We will still fit for P and TC for demonstrative purposes.</span>
<span class="n">per1</span> <span class="o">=</span> <span class="mf">5.5514926</span>
<span class="n">per1_unc</span> <span class="o">=</span> <span class="mf">0.0000081</span>
<span class="n">tc1</span> <span class="o">=</span>  <span class="mf">2457147.0529</span>
<span class="n">tc1_unc</span> <span class="o">=</span> <span class="mf">0.002</span>
<span class="n">ecc1</span> <span class="o">=</span> <span class="mf">0.077</span>
<span class="n">ecc1_unc</span> <span class="o">=</span> <span class="mf">0.024</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mi">55</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
<span class="n">w1_unc</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>

<span class="c1"># Period</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;per1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">per1</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;per1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">per1</span><span class="p">,</span> <span class="n">per1_unc</span><span class="p">))</span>

<span class="c1"># Time of conjunction</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;tc1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">tc1</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;tc1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">tc1</span><span class="p">,</span> <span class="n">tc1_unc</span><span class="p">))</span>

<span class="c1"># Eccentricity</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;ecc1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">ecc1</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;ecc1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">1E-10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;ecc1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">ecc1</span><span class="p">,</span> <span class="n">ecc1_unc</span><span class="p">))</span>

<span class="c1"># Angle of periastron</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;w1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">w1</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;w1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w1_unc</span><span class="p">))</span>

<span class="c1"># RV semi-amplitude</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">462</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;k1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Positive</span><span class="p">())</span>

<span class="c1"># Per instrument zero points</span>
<span class="c1"># Additional small offset is to avoid cases where the median is already subtracted off.</span>
<span class="k">for</span> <span class="n">instname</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="n">instname</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="mi">300</span>
    <span class="n">pname</span> <span class="o">=</span> <span class="s2">&quot;gamma_&quot;</span> <span class="o">+</span> <span class="n">instname</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">instname</span><span class="p">]</span><span class="o">.</span><span class="n">rv</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">200</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">200</span><span class="p">))</span>
    
<span class="c1"># Linear and quadratic trends, fix at zero</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;gamma_dot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s2">&quot;gamma_ddot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Per-instrument jitter (only fit for SONG jitter, TRES jitter is typically sufficient.)</span>
<span class="k">for</span> <span class="n">instname</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">pname</span> <span class="o">=</span> <span class="s2">&quot;jitter_&quot;</span> <span class="o">+</span> <span class="n">instname</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">jitter_dict</span><span class="p">[</span><span class="n">instname</span><span class="p">],</span> <span class="n">vary</span><span class="o">=</span><span class="n">jitter_dict</span><span class="p">[</span><span class="n">instname</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">vary</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">add_prior</span><span class="p">(</span><span class="n">pco</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">1E-10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

<span class="c1"># Initiate a composite likelihood object</span>
<span class="n">likes</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">RVPosterior</span><span class="p">()</span>

<span class="c1"># Define a single kernel and model, add to likelihoods</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">WhiteNoise</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">RVModel</span><span class="p">(</span><span class="n">planets_dict</span><span class="o">=</span><span class="n">planets_dict</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>
<span class="n">likes</span><span class="p">[</span><span class="s2">&quot;rvs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">RVLikelihood</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Define max like optimizer (iterative Nelder-Mead) and emcee MCMC sampler</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">NelderMead</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">likes</span><span class="p">)</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">AffInv</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">likes</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Construct a top-level RV &quot;problem&quot;</span>
<span class="n">rvprob</span> <span class="o">=</span> <span class="n">pco</span><span class="o">.</span><span class="n">RVProblem</span><span class="p">(</span><span class="n">output_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span> <span class="n">star_name</span><span class="o">=</span><span class="n">star_name</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">likes</span><span class="p">,</span> <span class="n">mstar</span><span class="o">=</span><span class="n">mstar</span><span class="p">,</span> <span class="n">mstar_unc</span><span class="o">=</span><span class="n">mstar_unc</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;EXAMPLE&quot;</span><span class="p">)</span>

<span class="c1"># Perform maximum a posteriori fit</span>
<span class="c1"># Results are saved to a pickle file with a unique timestamp.</span>
<span class="n">map_result</span> <span class="o">=</span> <span class="n">rvprob</span><span class="o">.</span><span class="n">mapfit</span><span class="p">()</span>

<span class="c1"># Alias best fit parameters</span>
<span class="n">pbest</span> <span class="o">=</span> <span class="n">map_result</span><span class="p">[</span><span class="s2">&quot;pbest&quot;</span><span class="p">]</span>

<span class="c1"># Plots</span>
<span class="c1"># All plots are interactive plotly figures and are automatically saved with a unique timestamp in the filename.</span>
<span class="n">rvprob</span><span class="o">.</span><span class="n">plot_phased_rvs_all</span><span class="p">(</span><span class="n">pbest</span><span class="p">)</span>
<span class="n">rvprob</span><span class="o">.</span><span class="n">plot_full_rvs</span><span class="p">(</span><span class="n">pbest</span><span class="p">)</span>

<span class="c1"># Set parameters from map fit</span>
<span class="n">rvprob</span><span class="o">.</span><span class="n">set_pars</span><span class="p">(</span><span class="n">pbest</span><span class="p">)</span>

<span class="c1"># Perform model comparison</span>
<span class="c1"># Results are saved to a pickle file</span>
<span class="n">mc_result</span> <span class="o">=</span> <span class="n">rvprob</span><span class="o">.</span><span class="n">model_comparison</span><span class="p">()</span>

<span class="c1"># Perform mcmc. Here we expose several kwargs which have defaults that will work for most cases.</span>
<span class="c1"># Results are saved to a pickle file.</span>
<span class="n">mcmc_result</span> <span class="o">=</span> <span class="n">rvprob</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">n_burn_steps</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">check_every</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">75_000</span><span class="p">,</span> <span class="n">rel_tau_thresh</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_min_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_cores</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_taus_thresh</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Corner plot, saved automatically</span>
<span class="n">rvprob</span><span class="o">.</span><span class="n">corner_plot</span><span class="p">(</span><span class="n">mcmc_result</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting best fit parameters from the max likelihood and mcmc sampling are saved to .pkl files. The best fit parameters from the max likelihood fitting are printed to the terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">per1</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">5.551493310923132</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Gaussian</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.5514926</span><span class="p">,</span> <span class="mf">8.1e-06</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">tc1</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">2457147.0529</span> <span class="p">(</span><span class="n">Locked</span><span class="p">)</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Gaussian</span><span class="p">:</span> <span class="p">[</span><span class="mf">2457147.0529</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">ecc1</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">0.03424765637223241</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Uniform</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">Gaussian</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.077</span><span class="p">,</span> <span class="mf">0.024</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">w1</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">0.7471046233814415</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Gaussian</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9599310885968813</span><span class="p">,</span> <span class="mf">0.2617993877991494</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">k1</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">441.5047007138727</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Positive</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">gamma_SONG</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">382.3918526498997</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Gaussian</span><span class="p">:</span> <span class="p">[</span><span class="mf">330.0031415926536</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">gamma_TRES</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">400.17917891086967</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Gaussian</span><span class="p">:</span> <span class="p">[</span><span class="mf">303.8031415926536</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">gamma_dot</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">0.0</span> <span class="p">(</span><span class="n">Locked</span><span class="p">)</span>
<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">gamma_ddot</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">0.0</span> <span class="p">(</span><span class="n">Locked</span><span class="p">)</span>
<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">jitter_SONG</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">69.62453494177453</span>
    <span class="n">Priors</span><span class="p">:</span>
        <span class="n">Uniform</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="p">(</span><span class="n">Parameter</span><span class="p">)</span>  <span class="n">Name</span><span class="p">:</span> <span class="n">jitter_TRES</span> <span class="o">|</span> <span class="n">Value</span><span class="p">:</span> <span class="mf">0.0</span> <span class="p">(</span><span class="n">Locked</span><span class="p">)</span>
</pre></div>
</div>
<p>The full RV model, data, and residuals.</p>
<img alt="../examples/KELT-24_rv_fitting/kelt24b_rvs_phased.png" src="../examples/KELT-24_rv_fitting/kelt24b_rvs_phased.png" />
<p>The phased RVs for each planet.</p>
<img alt="../examples/KELT-24_rv_fitting/kelt24_rvs_full.png" src="../examples/KELT-24_rv_fitting/kelt24_rvs_full.png" />
<p>The corner plot from mcmc sampling.</p>
<img alt="../examples/KELT-24_rv_fitting/KELT-24_corner_20210211_150814.png" src="../examples/KELT-24_rv_fitting/KELT-24_corner_20210211_150814.png" />
</div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>Here we perform the same Bayesian inference on KELT-24but use the webpage GUI.</p>
<p>First we modify our Python script. The majority of the code is identicical. Note we also import pychell.stutils.</p>
<p>This file is saved as kelt24_example_streamlit.py. We run it as streamlit run <code class="docutils literal notranslate"><span class="pre">kelt24_example_streamlit.py</span></code>. This will open a webpage that looks like the following:</p>
<img alt="../examples/KELT-24_rv_fitting/kelt24_streamlit_interface.png" src="../examples/KELT-24_rv_fitting/kelt24_streamlit_interface.png" />
<p>From here one can perform the desired actions. Here, the starting parameters are always what the user specifies in the script. All results are still saved to files, and interactive plots are shown in the browser.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/pychell_logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">pychell</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rv-fitting">RV Fitting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">Extending pychell</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="quickstart.html" title="previous chapter">Quickstart</a></li>
      <li>Next: <a href="extending.html" title="next chapter">Extending</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Bryson Cale.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tutorials.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>