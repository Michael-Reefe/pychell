
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pychell API reference &#8212; pychell  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/pychell_logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pychell API reference" href="spectrographs_api.html" />
    <link rel="prev" title="pychell API reference" href="template_generation_api.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pychell-api-reference">
<h1>pychell API reference<a class="headerlink" href="#pychell-api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pychell.rvs.rvcalc">
<span id="computing-rvs"></span><h2>Computing RVs<a class="headerlink" href="#module-pychell.rvs.rvcalc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pychell.rvs.rvcalc.combine_relative_rvs">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">combine_relative_rvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rvs</span></em>, <em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">n_obs_nights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.combine_relative_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines RVs considering the differences between all the data points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rvs</strong> (<em>np.ndarray</em>) – RVs</p></li>
<li><p><strong>weights</strong> (<em>np.ndarray</em>) – Corresponding uncertainties</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.compute_bisector_span">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">compute_bisector_span</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cc_vels</span></em>, <em class="sig-param"><span class="n">ccf</span></em>, <em class="sig-param"><span class="n">v0</span></em>, <em class="sig-param"><span class="n">n_bs</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.compute_bisector_span" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Bisector inverse slope of a given cross-correlation (RMS brute force) function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cc_vels</strong> (<em>np.ndarray</em>) – The velocities used for cross-correlation.</p></li>
<li><p><strong>ccf</strong> (<em>int</em>) – The corresponding 1-dimensional RMS curve.</p></li>
<li><p><strong>n_bs</strong> (<em>int</em>) – The number of depths to use in calculating the BIS, defaults to 1000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The line bisectors of the ccf.
bisector_span (float): The bisecor span of the line bisector (commonly referred to as the BIS).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>line_bisectors (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.compute_nightly_rvs_from_all">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">compute_nightly_rvs_from_all</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rvs</span></em>, <em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">n_obs_nights</span></em>, <em class="sig-param"><span class="n">flag_outliers</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">thresh</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.compute_nightly_rvs_from_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes nightly RVs for a single order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rvs</strong> (<em>np.ndarray</em>) – The individual rvs array of shape (n_orders, n_spec).</p></li>
<li><p><strong>weights</strong> (<em>np.ndarray</em>) – The weights, also of length (n_orders, n_spec).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.compute_nightly_rvs_single_order">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">compute_nightly_rvs_single_order</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rvs</span></em>, <em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">n_obs_nights</span></em>, <em class="sig-param"><span class="n">flag_outliers</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">thresh</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.compute_nightly_rvs_single_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes nightly RVs for a single order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rvs</strong> (<em>np.ndarray</em>) – The individual rvs array of shape (n_spec, n_chunks).</p></li>
<li><p><strong>weights</strong> (<em>np.ndarray</em>) – The weights, also of shape (n_spec, n_chunks).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.compute_relative_rvs_from_nights">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">compute_relative_rvs_from_nights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rvs</span></em>, <em class="sig-param"><span class="n">rvs_nightly</span></em>, <em class="sig-param"><span class="n">unc_nightly</span></em>, <em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">n_obs_nights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.compute_relative_rvs_from_nights" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines RVs considering the differences between all the data points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rvs</strong> (<em>np.ndarray</em>) – RVs</p></li>
<li><p><strong>weights</strong> (<em>np.ndarray</em>) – Corresponding uncertainties</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.compute_rv_content">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">compute_rv_content</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">snr</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">blaze</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ron</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">R</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wave_to_sample</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lsf</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.compute_rv_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the radial-velocity information content per pixel and for a whole swath.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>np.ndarray</em>) – The wavelength grid in units of Angstroms.</p></li>
<li><p><strong>flux</strong> (<em>np.ndarray</em>) – The flux, normalized to ~ 1.</p></li>
<li><p><strong>snr</strong> (<em>int</em><em>, </em><em>optional</em>) – The peak snr per 1d-pixel. Defaults to 100.</p></li>
<li><p><strong>blaze</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to modulate by a pseudo blaze function. The pseudo blaze is a polynomial where the end points</p></li>
<li><p><strong>ron</strong> (<em>int</em><em>, </em><em>optional</em>) – The read out noise of the detector. Defaults to 0.</p></li>
<li><p><strong>R</strong> (<em>int</em><em>, </em><em>optional</em>) – The resolution to convolve the templates. Defaults to 80000.</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – The LSF width to convolve the templates if R is not set. R=80000</p></li>
<li><p><strong>sampling</strong> (<em>float</em><em>, </em><em>optional</em>) – The desired sampling to compute the rv content on. Ideally, the input grid is sampled much higher than the detector grid for proper convolution, and sampling corresponds approximately to the detector grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The “rv information content” at each pixel.
np.ndarray: The rv content for the whole swath.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.crude_brute_force">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">crude_brute_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forward_model</span></em>, <em class="sig-param"><span class="n">templates_dict</span></em>, <em class="sig-param"><span class="n">sregion</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.crude_brute_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a pseudo cross-correlation via brute force RMS minimization and estimating the minumum with a quadratic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forward_model</strong> (<em>ForwardModel</em>) – A single forward model object.</p></li>
<li><p><strong>iter_index</strong> (<em>int</em>) – The iteration to use to construct the forward model. Not used, is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The forward model object with cross-correlation results stored in place.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>forward_model (ForwardModel)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.get_nightly_jds">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">get_nightly_jds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">jds</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.get_nightly_jds" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes nightly (average) JDs (or BJDs) for a time-series observation over several nights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jds</strong> (<em>np.ndarray</em>) – An array of sorted JDs (or BJDs).</p></li>
<li><p><strong>sep</strong> (<em>float</em>) – The minimum separation in days between two different nights of data, defaults to 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average nightly jds.
(np.ndarray): The number of observations each night.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.rv_solver">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">rv_solver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pars</span></em>, <em class="sig-param"><span class="n">rvs</span></em>, <em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">n_obs_nights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.rv_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function to optimize the rv offsets between orders.</p>
</dd></dl>

<dl class="py function">
<dt id="pychell.rvs.rvcalc.weighted_brute_force">
<code class="sig-prename descclassname">pychell.rvs.rvcalc.</code><code class="sig-name descname">weighted_brute_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forward_model</span></em>, <em class="sig-param"><span class="n">templates_dict</span></em>, <em class="sig-param"><span class="n">iter_index</span></em>, <em class="sig-param"><span class="n">sregion</span></em>, <em class="sig-param"><span class="n">xcorr_options</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pychell.rvs.rvcalc.weighted_brute_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a pseudo weighted cross-correlation via brute force RMS minimization and estimating the minumum with a quadratic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forward_model</strong> (<em>ForwardModel</em>) – A single forward model object.</p></li>
<li><p><strong>iter_index</strong> (<em>int</em>) – The iteration to use to construct the forward model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The velocities for the xcorr function.
(np.ndarray): The rms (xcorr) surface.
(np.ndarray): The xcorr RV (bary-center velocity subtracted).
(float): The BIS.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/pychell_logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">pychell</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">Extending pychell</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="reduce_api.html">Reduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="rvs_api.html">Radial Velocities</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectrographs_api.html">Spectroraphs</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api.html">pychell API reference</a><ul>
  <li><a href="rvs_api.html">pychell API reference</a><ul>
      <li>Previous: <a href="template_generation_api.html" title="previous chapter">pychell API reference</a></li>
      <li>Next: <a href="spectrographs_api.html" title="next chapter">pychell API reference</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Bryson Cale.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/rvs_sub_api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>